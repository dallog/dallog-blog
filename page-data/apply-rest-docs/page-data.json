{"componentChunkName":"component---src-templates-post-jsx","path":"/apply-rest-docs/","result":{"data":{"site":{"siteMetadata":{"title":"dal.log"}},"markdownRemark":{"id":"cade544a-16ef-58a3-b97c-824986a8395f","excerpt":"이 글은 우테코 달록팀 크루 '리버'가 작성했습니다. Rest Docs Spring Rest Docs는 테스트 코드 기반으로 자동으로 Rest API 문서를 작성 할 수 있도록 도와주는 프레임 워크이다. Rest Docs와 Swagger 자바 문서 자동화에는 주로 Rest Docs와 Swagger가 사용된다.\n각 자동화 프레임 워크의 장단점을 살펴보자.\n…","html":"<blockquote>\n<p>이 글은 우테코 달록팀 크루 '<a href=\"https://github.com/gudonghee2000\">리버</a>'가 작성했습니다.</p>\n</blockquote>\n<h2>Rest Docs</h2>\n<p>Spring Rest Docs는 테스트 코드 기반으로 자동으로 Rest API 문서를 작성 할 수 있도록 도와주는 프레임 워크이다.</p>\n<h2>Rest Docs와 Swagger</h2>\n<p>자바 문서 자동화에는 주로 Rest Docs와 Swagger가 사용된다.\n각 자동화 프레임 워크의 장단점을 살펴보자.\n<span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/d2b4c0c198f8d46b6e00d12cfb0f88eb/90694/compare.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 33.529411764705884%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAABJ0AAASdAHeZh94AAABTUlEQVQY03XLy07CQBQG4D6hEcWVC9mb+AAqsDCRnYmP4kKRKIpCi+20BVpboFw6M73fbKFa484jbjX5Mjn/mfMz5Rq/U+UrDXR4gQ7O+e0TrrRRrvPlmrB/xh9dipWGsHXMlU65nWp/t8rv1QVoAUbSIlmPWZFetQatJ+32UW22R80HhRWJrEUvQ+e6rbY6Oixv7gd3z3qnP0eKL71GUGTitEiyTy/MTOITK1yYLgw/Lw3COAeEBsSOMPHnBl6aDnxRO0rXX0laMNhZEzdf0jdtYmtTZ2x4Y8MdzzyIuuGaVgrz5Nfcn4JFMF2EcLm0MkZSQyAqPitgDhFOpByiLCIswpxERSXo8kuIPQF3ebMH4EykPcFEI5/B9po4+cyMBNkYqljRLaDqFpJn0miBrYy6+Z+gyIRJAYL43fFSN1h5wcrdsCH6qzD5+F/xDaT1WJ5R4sEDAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='compare' title='compare' src='/static/d2b4c0c198f8d46b6e00d12cfb0f88eb/ca1dc/compare.png' srcset='/static/d2b4c0c198f8d46b6e00d12cfb0f88eb/e7570/compare.png 170w,\n/static/d2b4c0c198f8d46b6e00d12cfb0f88eb/f46e7/compare.png 340w,\n/static/d2b4c0c198f8d46b6e00d12cfb0f88eb/ca1dc/compare.png 680w,\n/static/d2b4c0c198f8d46b6e00d12cfb0f88eb/02d09/compare.png 1020w,\n/static/d2b4c0c198f8d46b6e00d12cfb0f88eb/90694/compare.png 1318w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>Swagger는 API 문서의 작성을 위해 프로덕션 코드에 추가적인 코드를 작성해야한다.\n그래서 Swagger의 사용은 프로덕션 코드의 가독성을 떨어트린다고 생각한다.</p>\n<p>반대로, Spring Rest Docs는 테스트 코드에 의존적이기 때문에 Spring Rest Docs를 사용하는것이 좋다고 생각한다.</p>\n<h2>MockMvc vs Rest Assured</h2>\n<p>Spring Rest Docs를 사용하여 문서를 작성 하려면 테스트 코드가 필요하다.\n테스트 코드를 작성 할 때, 대표적으로 MockMvc와 Rest Assured를 사용한다.</p>\n<p>MockMvc를 사용하면  <code class=\"language-text\">@WebMvcTest</code>로 테스트 할 수 있다.\n그래서 Controller Layer만으로 테스트 하기 때문에 테스트 속도가 빠르다.</p>\n<p>반면, RestAssured는 <code class=\"language-text\">@SpringBootTest</code>로 수행해야한다. 그러면 전체 어플리케이션 컨텍스트를 로드하여 빈을 주입하기에 테스트 속도가 느리다.\n하지만, 실제 객체를 통한 테스트가 가능하기 때문에 테스트의 신뢰성이 높다.</p>\n<p>통합 테스트, 인수 테스트의 경우 RestAssuerd가 좋을 수 있지만, 문서를 작성하기 위한 테스트에는 MockMvc가 더 적절하다고 생각한다.</p>\n<p><strong><em>💡 @WebMvcTest와 @SpringBootTest</em></strong>\n@WebMvcTest는 Application Context를 완전하게 Start하지 않고 Present Layer 관련 컴포넌트만 스캔하여 빈 등록한다.\n반면, @SpringBootTest의 경우 모든 빈을 로드하여 등록한다.</p>\n<h2>AsciiDoc</h2>\n<p>Spring Boot Rest Docs는 Asciidoc를 문서 번역을 위한 텍스트 프로세서로 사용한다.</p>\n<h2>Rest Docs API 문서 생성 매커니즘</h2>\n<p>우선, Rest Docs의 문서 생성 매커니즘을 살펴보자.</p>\n<ol>\n<li>MockMvc로 작성한 테스트 코드를 실행한다.</li>\n<li>\n<p>테스트가 통과하면 아래와 같이 <code class=\"language-text\">build/generated-snippets</code> 하위에 스니펫(문서조각)들이 생성된다.\n<span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 311px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/f94923887173d0bfee01596d1d760923/fedc7/first.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 99.41176470588235%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAACAUlEQVQ4y41Te2/aMBDnO3WQ2EkIAUp5JPbd2U7KQ4D2UFtoh9iq/dd99p1TdV3V0SBdTnGkn3+Py7X0rEc42UL6RKGByKC0OtLTjL83VosfKAYLlR0xXqKoUBid6ElfT88Dq2lKepTrq98Q7lGQCeeu7TBSTfwv4KJPangA+RkkYeR0gnl6LrPRA9TDXxDeMpiE1bGaZOcyG33Jyhl8g8zMzmVFojIBFt0GsJ6lWPRRDY8gv3LaKEuISoy4myLFvMdFeQ9OelYDgtETdvYmVDaoDNOGXBwb90XVnrvO+xRar4dpCjD+AvEjCVDSgrC1CofCkYT/5fcKZlWoL7cqfQRZ2rSykQNRMhL9LWyNJw8nmWtyNctGV8nPw2GzIlO0vXkSXJzftTci4CTY82fFOHm4+7ZeFkYHRiWuFm+BK+II/nXeeucky8fxj91uu1IlXpQQe1oTlhTW5AHm3QbwYb/brLSFtoWYmUsfm2fm+bEE+BCcfN/drpeKwQZiW4Ofb3HEKcb4MfNx72U7uuCErE5KL5uTl6UJSiMawPf7m/VCk+o4vySRq6dtdMQqOEKYNjDfbZbs+RMzOx47/2f1tCqSvHDwsjBvwIp7Xqd9/7BdaYcMrjeEV8U8Zy6vbUBF+hacZ5BnVd71Y5ym67kpaURKko5JJVQkyJ3f/TH++6v+AeD8X7vWRAwgAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='first' title='first' src='/static/f94923887173d0bfee01596d1d760923/fedc7/first.png' srcset='/static/f94923887173d0bfee01596d1d760923/e7570/first.png 170w,\n/static/f94923887173d0bfee01596d1d760923/fedc7/first.png 311w' sizes='(max-width: 311px) 100vw, 311px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p><em>❗❗ gradle은 build/generated-snippets에 스니펫이 생성된다.</em></p>\n</li>\n<li><code class=\"language-text\">build/generated-snippets</code> 하위에 생성된 스니펫들을 묶어서 HTML 문서를 만들기 위해서는, gradle의 경우 아래와 같이<code class=\"language-text\">src/docs/asciidoc</code> 하위에 스니펫들을 묶은 adoc문서를 만든다.<span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 339px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/14846100df54ad09c5367e8df4aaecb2/527f2/second.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 41.76470588235294%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABIUlEQVQY042OS0vDQBSFs7TWtQvBx6a0SGla+zDznjszSSbpNI1NSYVWxQeoG///0qEFUcEifKt7zse5gQBNhASTFNVq8/KWueKmqrNZgbmgEv6CScCUBxQMEYqrOJsv67vnNHc6zYSO/XE/ERUBIn5BMzD5vFrdP8V2SqXxwf9kzL2MOXgfYvv4/uHKZV6U/qNrKhCDfTKhjPllqTygk8S61fqhXNbKpNnUmcTuol9wqRATwRjxPobBliHVI2bSxcYu1totIC9ZOguR/Cr8IOLBeYgP2vyow5sdfthmjRYJTkdn4zyuXy8ucasve0N90pWNNmtuOzsaHX7cJcEwYj0EYSQHRE+kVfNbpKaxq7QtR0RNqJ5QdYXB74e+9p2IfwKrT3TYBiaq6gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='second' title='second' src='/static/14846100df54ad09c5367e8df4aaecb2/527f2/second.png' srcset='/static/14846100df54ad09c5367e8df4aaecb2/e7570/second.png 170w,\n/static/14846100df54ad09c5367e8df4aaecb2/527f2/second.png 339w' sizes='(max-width: 339px) 100vw, 339px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></li>\n<li>스니펫을 이용해서 <code class=\"language-text\">src/docs/asciidoc</code> 하위에 adoc 파일을 생성했다면, <code class=\"language-text\">./gradlew build</code> 명령어를 통해 빌드를 해준다.\n<span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 353px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/a7bf9f7dfb5ce4935434e295f7a8b010/8e4bf/third.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 62.94117647058823%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAABiklEQVQoz42S207CQBCGfQoE1HjlhUbbIniAdruz3S203R63hVYMiDHRKInvf+m0Em48pMmfzR7+LzM7MwdjAoQJ5nrqYRVE6dQPQcxM6vwn4GOLXg9vDvBgOy735Pp1G0QJAX5v0bbwxGYoDI5YuX7JyuUsqIPjZQuY1CaEqePOH5+SeSXjDJNvB9s72AauNm/R87YqqzBVmLwFvBWMwg0Av8uW4+WrlBFW4c60f4//EzYpx8x9tYir1dSTrh9iC4BPW8IOcVyZqPVj4UcJ/vz789jLP2GCrYKdCGWUcS8Inz8+ZazCJAviNMpyyl182tvQY5IG7mj2oUb36qIM1tXZUOZXIC9G4vxWnA1ZT6OdK3rYCDcnmjVEGG97+k59A/q46vRoIAa50IVjjBztFi5HcGwAOvt6bejq9NRoYJvxWk0+mMyEEALifbspFkVeVJEq0qKMEqXyYr4oVTFPsgz9pg1NwagzbkqFQ6qqVZyXQZjMPEGFoHxaTx6OAKtfUdh5i4lJM8IIfwEBQsLymO4IDwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='third' title='third' src='/static/a7bf9f7dfb5ce4935434e295f7a8b010/8e4bf/third.png' srcset='/static/a7bf9f7dfb5ce4935434e295f7a8b010/e7570/third.png 170w,\n/static/a7bf9f7dfb5ce4935434e295f7a8b010/f46e7/third.png 340w,\n/static/a7bf9f7dfb5ce4935434e295f7a8b010/8e4bf/third.png 353w' sizes='(max-width: 353px) 100vw, 353px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n빌드가 완료되면 위와 같이 <code class=\"language-text\">resources - static - docs</code> 하위에 HTML 문서가 생성된다.</li>\n<li>\n<p>어플리케이션을 실행 한 후, <code class=\"language-text\">http://localhost:8080/docs/{HTML 파일명}</code> 을 웹브라우저에 검색하면 생성한 REST API 문서를 확인 할 수 있다. </p>\n<p><strong>❗❗ API문서 url은 코드를 통해 변경 가능하다.</strong></p>\n</li>\n</ol>\n<h3>❗유의할 점</h3>\n<p>resources - static - docs 하위의 HTML 파일은 실제로는 build.gradle의 설정파일에 따라서 위와같이 build - docs - asciidoc 하위의 HTML 파일을 복사해온 파일이다.\n<span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 352px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/1c4dd4c620257df717630f3974410098/3a2f8/four.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 48.23529411764706%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABIklEQVQoz32RS0/DMBCE85s4NH6ksdOEtHb8WDtxogKFQ6VKcGsPSBz55yylKpe00lxs+fPMzmZVJdq20Wr98vzUaWksaVpR19V9IZXnNPOqjLDegfz2DynSAeWWTlfQyVsKRlolFjnJnBa+k9HVA7SnQPeR98BG4PgC72cFRholckoRLvEc7ApcewS2h2IINAUWrLgPLzA2xnD6F8bwX0AOkfmeRiudWnld3YXJxdmfh4l+8wHLU6TekwnQn3sj5uGNIIRlVpXX2+iaN1cePN9OjykWKVAMD7ecCT3D5hIPV6VUpc1qd+zTWI5AtikfA5t1zgn9bzv49hPYIbA+sjSRsacJO+8E6NvOfzMDmtvm3RWvgKvig+MD/uKWMNfZtbAfFm+qS78dXqMAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='four' title='four' src='/static/1c4dd4c620257df717630f3974410098/3a2f8/four.png' srcset='/static/1c4dd4c620257df717630f3974410098/e7570/four.png 170w,\n/static/1c4dd4c620257df717630f3974410098/f46e7/four.png 340w,\n/static/1c4dd4c620257df717630f3974410098/3a2f8/four.png 352w' sizes='(max-width: 352px) 100vw, 352px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<h3>아이디어</h3>\n<p>REST API 문서를 확인할 때, <code class=\"language-text\">http://localhost:8080/docs/{HTML 파일명}</code> 을 통해서 웹브라우저에 접근하지 않아도 확인하는 방법이 있다.\n<span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/761a34bf571d990e90fd93be1543a239/867ee/five.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 58.82352941176471%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABxUlEQVQoz22Ri46cIBSGfZIZZ7ZZFRBQ8K6Id5xR27RNb+//ID3s7G6yTU++4G/053B+nPH4k/V71m+w5sMBgEg7+5roW6xM0t5AyNZqqe9Cb4DUe3E7nKy95doU2iT1WPW3XC2i7EXRRbmWzZQ0c2LXN9ScqAWQammn1RFCpmlCMEKBj3wP+c8hCYtUUkYZ55TSwPcv7uUNF3DP7tP1Wredk4pIcEJDjMmHwhinWZGXdSQSHot/iGVSKm3NWRwKHnIavhelIUK4n6avP36abV/3w+zH+pF2mJyIM8lwzKyHACS0bQkOgkDp7vuv32AeFjOadVwMiH5eABCqH605YiSC8Rh7GZLD0x4aYzibPWQkKItIyDChAcKeHwAgiqZ1BHTmRMIe3AIpwR7QHb6XdTMZ041TpXRRN2XTVuqVutW1HhxKGbZh2QO/1yOzWEgGPaGhjzwvuF4+nc7u+Xw5nSD3p7xSDzMCP0Lwx7P3Ur7v+Z4n0wzSTvMiKyoQMs1hkAciySq4KrhJa0YIZh7mdYZsII9x1t0ACUFai2Vb7htos7+y7rtNW4qMcciDRrFYty/349t6P0CY+2eYtu66puv/S637v4zpm5Q7i9sbAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='five' title='five' src='/static/761a34bf571d990e90fd93be1543a239/ca1dc/five.png' srcset='/static/761a34bf571d990e90fd93be1543a239/e7570/five.png 170w,\n/static/761a34bf571d990e90fd93be1543a239/f46e7/five.png 340w,\n/static/761a34bf571d990e90fd93be1543a239/ca1dc/five.png 680w,\n/static/761a34bf571d990e90fd93be1543a239/02d09/five.png 1020w,\n/static/761a34bf571d990e90fd93be1543a239/9d567/five.png 1360w,\n/static/761a34bf571d990e90fd93be1543a239/867ee/five.png 1586w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\nAsciiDoc 플러그인을 설치하면 위와같이, 인텔리제이 상에서도 REST API 문서를 실시간으로 확인할수 있다.  (✔설치 추천)</p>\n<h2>Rest Docs 사용을 위한 빌드파일 설정</h2>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">plugins <span class=\"token punctuation\">{</span>\n    id 'org<span class=\"token punctuation\">.</span>asciidoctor<span class=\"token punctuation\">.</span>jvm<span class=\"token punctuation\">.</span>convert' version <span class=\"token char\">'3.3.2'</span> <span class=\"token comment\">// 1</span>\n<span class=\"token punctuation\">}</span>\n\next <span class=\"token punctuation\">{</span>\n    snippetsDir <span class=\"token operator\">=</span> <span class=\"token function\">file</span><span class=\"token punctuation\">(</span>'build<span class=\"token operator\">/</span>generated<span class=\"token operator\">-</span>snippets'<span class=\"token punctuation\">)</span> <span class=\"token comment\">// 2</span>\n<span class=\"token punctuation\">}</span>\n\ntest <span class=\"token punctuation\">{</span> \n    outputs<span class=\"token punctuation\">.</span>dir snippetsDir <span class=\"token comment\">// 3</span>\n    <span class=\"token function\">useJUnitPlatform</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\nconfigurations <span class=\"token punctuation\">{</span>\n    asciidoctorExtensions\n<span class=\"token punctuation\">}</span>\n\nasciidoctor <span class=\"token punctuation\">{</span> <span class=\"token comment\">// 4</span>\n    configurations 'asciidoctorExtensions' \n    inputs<span class=\"token punctuation\">.</span>dir snippetsDir \n    dependsOn test\n<span class=\"token punctuation\">}</span>\n\ndependencies <span class=\"token punctuation\">{</span>\n    testImplementation 'org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>restdocs<span class=\"token operator\">:</span>spring<span class=\"token operator\">-</span>restdocs<span class=\"token operator\">-</span>mockmvc' <span class=\"token comment\">// 5</span>\n    asciidoctorExtensions 'org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>restdocs<span class=\"token operator\">:</span>spring<span class=\"token operator\">-</span>restdocs<span class=\"token operator\">-</span>asciidoctor' <span class=\"token comment\">// 6</span>\n<span class=\"token punctuation\">}</span>\n\ntask <span class=\"token function\">copyDocument</span><span class=\"token punctuation\">(</span>type<span class=\"token operator\">:</span> <span class=\"token class-name\">Copy</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// 7</span>\n    dependsOn asciidoctor\n    \n    from <span class=\"token function\">file</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"build/docs/asciidoc\"</span><span class=\"token punctuation\">)</span>\n    into <span class=\"token function\">file</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"src/main/resources/static/docs\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\t\nbootJar <span class=\"token punctuation\">{</span> \n    dependsOn copyDocument <span class=\"token comment\">// 8</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ol>\n<li>gradle7부터 사용하는 플러그인으로 asciidoc 파일 변환, build 디렉토리에 복사하는 플러그인이다.</li>\n<li>생성된 스니펫을 저장할 위치를 정의한다. gradle은 <code class=\"language-text\">build/generated-snippets</code>에 스니펫이 생성된다.</li>\n<li>테스트 Task의 결과 아웃풋 디렉토리를 <code class=\"language-text\">build/generated-snippets</code>로 지정한다.</li>\n<li>asciidoctor Task가 사용할 인풋 디렉토리를 <code class=\"language-text\">build/generated-snippets</code>로 지정한다.\ndependsOn test로 문서가 작성되기 전에 테스트가 실행되도록 한다.</li>\n<li>MockMvc를 테스트에 사용하기 위한 의존성을 추가 해준다.</li>\n<li>일반 텍스트를 처리하고 HTML 파일을 생성하는 의존성을 추가 해준다.</li>\n<li>asciidoctor Task로 생성한 <code class=\"language-text\">build/docs/asciidoc</code>파일을 <code class=\"language-text\">src/main/resources/static/docs</code>로 복사한다.</li>\n<li>bootJar 실행시 copyDocument를 먼저 실행하도록 한다.</li>\n</ol>\n<hr>\n<p>✅MockMvc를 사용한 Rest Docs 테스트 작성을 알아보기 전에 우선 MockMvc에 대해 알아보자.</p>\n<h2>MockMvc 기본 메서드</h2>\n<p>어떠한 것들이 있는지 알아보고 밑에서 자세히 알아보자.</p>\n<h3>perform()</h3>\n<p>가상의 request를 처리한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">mockMvc<span class=\"token punctuation\">.</span><span class=\"token function\">perform</span><span class=\"token punctuation\">(</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/api/schedules/?year=2022&amp;month=7\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3>andExpert()</h3>\n<p>andExpert()</p>\n<p>예상값을 검증한다. </p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token punctuation\">.</span><span class=\"token function\">andExpect</span><span class=\"token punctuation\">(</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">isOk</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// status 값이 정상인 경우를 기대하고 만든 체이닝 메소드의 일부</span>\n\n<span class=\"token punctuation\">.</span><span class=\"token function\">andExpect</span><span class=\"token punctuation\">(</span><span class=\"token function\">content</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">contentType</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"application/json;charset=utf-8\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">//contentType을 검증</span></code></pre></div>\n<h3>andDo()</h3>\n<p>요청에 대한 처리를 맡는다. print() 메소드가 일반적이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token punctuation\">.</span><span class=\"token function\">andDo</span><span class=\"token punctuation\">(</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3>andReturn()</h3>\n<p>테스트한 결과 객체를 받을 때 사용한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">MvcResult</span> result <span class=\"token operator\">=</span> mockMvc<span class=\"token punctuation\">.</span><span class=\"token function\">perform</span><span class=\"token punctuation\">(</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">.</span><span class=\"token function\">andDo</span><span class=\"token punctuation\">(</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">.</span><span class=\"token function\">andExpect</span><span class=\"token punctuation\">(</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">isOk</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">.</span><span class=\"token function\">andReturn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2>MockMvc 요청 만들기</h2>\n<p>요청을 만들 때는 static 메서드인 get, post, put, delete, fileUpload 등을 이용해서 MockHttpServletRequestBuilder 객체를 생성하는 것에서 시작한다.</p>\n<p>MockHttpServletRequestBuilder는 ServletRequest를 구성하기에 필요한 다양한 메서드를 제공한다.\n<span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/339d06cdbd29be2a7151137a00024a12/7a863/six.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 58.235294117647065%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAABJ0AAASdAHeZh94AAACD0lEQVQozz2QTYvTQBjH88HUghcPHr159APsVg/ixZt+A99gQUHcdRUUEUT3IkrSNGmbSTN5nWSSmaQv22aSJou0K5580nQLP4Znfs8z8H9GunEoA9cPlTuPtXtPtduP+tcOlMYcyDcf9Drdptvpqrce9u8+GQKd+2qnq7SvpOMf/OQsffuNHn12X38Jjj45774zkMD7M2hxuL78YL76OH5xip6fomcnozdfQ3gCA1LMqoTXJBKWkznebIxTmqxAbn1zwtWyMxNzc8wMM0EWC6mIWQ0tKS83YnWZzUo/TNNp4RE+W9RgwAPLYl1Uf/kkd3zmBhxmCJ3mq03blUhctbhEGFbqhWJvwmRX+LQcmkxHsWZQh+Tkyks4KACblKaz7A+TsZfbWwM4pGhqv7A80R8xWYt6A4rsc3w1ILUBIOd8eRHGMzj3mfNyDbHL+h/LhOVS12d+mAGwyC52yKoW7E1HKMbeLOL1XkKN/Tmy4LcSNGbaKBxCgTOSrKArWZCqodRRJqtkgDIclK2EwFBraKLqsQqZ9fhXL5B12hvAdgIGIPYaENXlZFa6bjxfQOzNTq7WC/EH/pmlS0LSiE4huRekTsC3220kmtYtbjC3MIczzi5oWrUSaic4h42wnZoWG6DIsBLT5hFvBiTDzhscoepMVog2TJEjWokAR/SNqaxSaCl68lMhv6HW2QgvYeA/pmdSXa5mm6MAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='six' title='six' src='/static/339d06cdbd29be2a7151137a00024a12/ca1dc/six.png' srcset='/static/339d06cdbd29be2a7151137a00024a12/e7570/six.png 170w,\n/static/339d06cdbd29be2a7151137a00024a12/f46e7/six.png 340w,\n/static/339d06cdbd29be2a7151137a00024a12/ca1dc/six.png 680w,\n/static/339d06cdbd29be2a7151137a00024a12/02d09/six.png 1020w,\n/static/339d06cdbd29be2a7151137a00024a12/7a863/six.png 1139w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n위 메서드들은 메서드 체이닝을 지원하기 때문에, 아래와 같이 요청 데이터를 연결해서 작성하면된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Test</span>\n    <span class=\"token keyword\">void</span> <span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">MockHttpServletRequestBuilder</span> builder <span class=\"token operator\">=</span> <span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/api/schedules\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">param</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"year\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"2022\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">param</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"month\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"7\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">accept</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MediaType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">APPLICATION_JSON</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"sessionId\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"세션아이디입니다.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        mockMvc<span class=\"token punctuation\">.</span><span class=\"token function\">perform</span><span class=\"token punctuation\">(</span>builder<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">andExpect</span><span class=\"token punctuation\">(</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">isOk</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<p><em><strong>❗❗ 유의 할 점</strong></em>\nMockMvc.perform() 의 파라미터 값이 MockHttpServletRequestBuilder의 상위 객체이다. </p>\n<p>그래서 perform() 파라미터로 아래와 같이 넣어주어도 작동된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Test</span>\n    <span class=\"token keyword\">void</span> <span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n        mockMvc<span class=\"token punctuation\">.</span><span class=\"token function\">perform</span><span class=\"token punctuation\">(</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/api/schedules\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">param</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"year\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"2022\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">param</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"month\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"7\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">accept</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MediaType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">APPLICATION_JSON</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"sessionId\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"세션아이디입니다.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">andExpect</span><span class=\"token punctuation\">(</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">isOk</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<h2>MockMvc 실행 결과 검증</h2>\n<p>perform()은 반환 값으로 ResultActions가 반환된다.\nResultActions의 andExpect는 요청 실행 결과를 검증 하려면 ResultMatcher를 넘겨줘서 검증해야한다.\nResultMatcher는 다음의 MockMvcResultMatchers가 가지는 static 메서드를 통해서 얻는다.</p>\n<p>MockMvcResultMatchers는 다음의 static 메서드를 통해 다양한 ResultMatcher를 제공한다.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/c2f972798e14e46166995818bb7fdcd2/7a863/seven.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 42.94117647058824%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAABJ0AAASdAHeZh94AAABoUlEQVQozz2OT2vUQBiH53NpF0HQb+DBgxfvbRXs0ZssWAVB1Jtg1YOF6k2Qoq27m26X3U3SySSTP5PNJJkkm002TU2tXn3TWQsPw/s+72/gh9Y2BsD19cGdx8P73dHtR8q19ZW5+bDf2WznzsbRra3h3Sfje93pjQfDzqYif6FXe17LZ/byE33xEa/WS958Ya/B7zrbO/rTd+qz99r2jtZ9O37+AUMeAogFp4DPa+rmuhHJ9b9svctKTGIdh8BE9cdTj5iC8RoCaF7+BvLlRZhUlhuni0YayaL6w3huOqHjp7afYCsAqBdDHq6Ii19AmDQsWGIrDuJamitmUU29uUGFTrhm8BMSMl7JE9KtEjihywme90e+ZhbSXMr2xXY1wVl/NDsY2D+P3MFoBmEZQDnUK84Xy4soqWwmxPwMZpASqA1XA6q6glBOaEhoEERFUf2FK4rSpiU7D6JTm2VhcrYyaRNnDRe17WWWm5qOMG0BA7ZC6qWMlxBAmllKpkaujPnVqpIC6h2r8dd9tTdk33v0UHF7x/63H3j/kBwoDmT+ATySs4QQFb3nAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='seven' title='seven' src='/static/c2f972798e14e46166995818bb7fdcd2/ca1dc/seven.png' srcset='/static/c2f972798e14e46166995818bb7fdcd2/e7570/seven.png 170w,\n/static/c2f972798e14e46166995818bb7fdcd2/f46e7/seven.png 340w,\n/static/c2f972798e14e46166995818bb7fdcd2/ca1dc/seven.png 680w,\n/static/c2f972798e14e46166995818bb7fdcd2/02d09/seven.png 1020w,\n/static/c2f972798e14e46166995818bb7fdcd2/7a863/seven.png 1139w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>아래의 예시를 살펴보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">\t<span class=\"token annotation punctuation\">@Test</span>\n    <span class=\"token keyword\">void</span> <span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n        mockMvc<span class=\"token punctuation\">.</span><span class=\"token function\">perform</span><span class=\"token punctuation\">(</span>builder<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">andExpect</span><span class=\"token punctuation\">(</span><span class=\"token function\">handler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">handlerType</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ScheduleController</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">andExpect</span><span class=\"token punctuation\">(</span><span class=\"token function\">handler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">methodName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"save\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">andExpect</span><span class=\"token punctuation\">(</span><span class=\"token function\">forwardedUrl</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"index\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">andExpect</span><span class=\"token punctuation\">(</span><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringValues</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Content-Language\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"en\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">andExpect</span><span class=\"token punctuation\">(</span><span class=\"token function\">model</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">attribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"message\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"저장이 잘되었습니다.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">andExpect</span><span class=\"token punctuation\">(</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">isOk</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<h2>MockMvc 실행 결과 처리</h2>\n<p>실행 결과를 출력할 떄는 andDo 메서드를 사용한다.\nandDo 메서드 의 인수에는 실행 결과를 처리 할 수 있는 ResultHandler를 지정한다.\nMockMvcResultHandlers는 다양한 ResultHandler를 제공하지만 print()를 주로 사용한다.</p>\n<h2>MockMvc를 사용한 Rest Docs 생성</h2>\n<p>테스트 코드와 함께 MockMvc를 사용한 Rest Docs 생성을 알아보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@WebMvcTest</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ScheduleController</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n<span class=\"token annotation punctuation\">@AutoConfigureRestDocs</span> <span class=\"token comment\">// 1</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ScheduleControllerTest</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token annotation punctuation\">@Autowired</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">MockMvc</span> mockMvc<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@Autowired</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">ObjectMapper</span> objectMapper<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@MockBean</span> <span class=\"token comment\">// 2</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">ScheduleService</span> scheduleService<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@Test</span>\n    <span class=\"token keyword\">void</span> <span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// given</span>\n        <span class=\"token class-name\">ScheduleCreateRequest</span> request <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ScheduleCreateRequest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"제목\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">LocalDateTime</span><span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">LocalDateTime</span><span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"메모\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token function\">given</span><span class=\"token punctuation\">(</span>scheduleService<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">willReturn</span><span class=\"token punctuation\">(</span><span class=\"token number\">1L</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 3</span>\n\n        <span class=\"token comment\">// when &amp; then</span>\n        mockMvc<span class=\"token punctuation\">.</span><span class=\"token function\">perform</span><span class=\"token punctuation\">(</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/api/schedules\"</span><span class=\"token punctuation\">)</span>\n                        <span class=\"token punctuation\">.</span><span class=\"token function\">content</span><span class=\"token punctuation\">(</span>objectMapper<span class=\"token punctuation\">.</span><span class=\"token function\">writeValueAsString</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                        <span class=\"token punctuation\">.</span><span class=\"token function\">contentType</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MediaType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">APPLICATION_JSON</span><span class=\"token punctuation\">)</span>\n                        <span class=\"token punctuation\">.</span><span class=\"token function\">accept</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MediaType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">APPLICATION_JSON</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">andExpect</span><span class=\"token punctuation\">(</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">isOk</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">andDo</span><span class=\"token punctuation\">(</span><span class=\"token function\">document</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"schedule-save\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 4</span>\n                        <span class=\"token function\">requestFields</span><span class=\"token punctuation\">(</span>\n                                <span class=\"token function\">fieldWithPath</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"title\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">type</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonFieldType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">STRING</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">description</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"제목\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                                <span class=\"token function\">fieldWithPath</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"startDateTime\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">type</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonFieldType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">STRING</span><span class=\"token punctuation\">)</span>\n                                        <span class=\"token punctuation\">.</span><span class=\"token function\">description</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"2022-07-04T13:00\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                                <span class=\"token function\">fieldWithPath</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"endDateTime\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">type</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonFieldType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">STRING</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">description</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"2022-07-05T07:00\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                                <span class=\"token function\">fieldWithPath</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"memo\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">type</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonFieldType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">STRING</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">description</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"메모입니다.\"</span><span class=\"token punctuation\">)</span>\n                        <span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ol>\n<li>target/generated-snippets dir 생성하고 테스트 코드를 통해 snippets를 추가해주는 애노테이션이다.</li>\n<li><code class=\"language-text\">ScheduleService</code>를 mocking을 하기위해서 <code class=\"language-text\">@MockBean</code> 을 선언한다.</li>\n<li>mocking을 통해 <code class=\"language-text\">ScheduleService</code> 를 통해 받을 응답값을 설정한다.</li>\n<li>test 수행시 <code class=\"language-text\">andDo(document(\"xxx\"))</code>를 통해서 <code class=\"language-text\">./build/generated-snippets</code> 하위에 문서가 작성된다.</li>\n</ol>\n<hr>\n<h2>끝내면서</h2>\n<p>이상 Rest Docs의 매커니즘, 설정 그리고 MockMvc를 활용한 Rest Docs 생성 방법을 살펴보았다.\n프로젝트에 RestAssuered를 사용한 Rest Docs를 적용하면서 테스트 격리에 문제를 경험하였는데,\n테스트 격리에 대해서 추후에 포스팅 해봐야겠다.</p>","frontmatter":{"title":"MockMvc를 사용한 Spring RestDocs","date":"July 26, 2022","update":"July 26, 2022","tags":["Spring","Rest API"],"series":null},"fields":{"slug":"/apply-rest-docs/","readingTime":{"minutes":10.35}}},"seriesList":{"edges":[{"node":{"id":"a621dc7b-8590-5ec6-9b52-3d9e5182486d","fields":{"slug":"/appearance-background-of-jpa/"},"frontmatter":{"title":"JPA 등장배경"}}},{"node":{"id":"9d2a87b6-2b9c-5b87-b790-3426d17c2d8e","fields":{"slug":"/intellij-final-keyword/"},"frontmatter":{"title":"IntelliJ에서 메소드 추출한 메소드의 파라미터에 final 키워드 자동 추가하기"}}},{"node":{"id":"251e9767-1c92-5cf5-9cef-2c4a42c10df2","fields":{"slug":"/git-branch-strategy/"},"frontmatter":{"title":"달록팀의 git 브랜치 전략을 소개합니다."}}},{"node":{"id":"5090cce3-0c1f-5376-badc-1d25e44c1bd9","fields":{"slug":"/infinite-scroll/"},"frontmatter":{"title":"React에서 무한 스크롤 구현하기"}}},{"node":{"id":"bcb53ba5-0286-5d10-96c2-fdcb88e2cc60","fields":{"slug":"/package-structure/"},"frontmatter":{"title":"달록에 적절한 패키지 구조 고민하기"}}},{"node":{"id":"a7fc89de-f37c-596e-a81d-3d4fe5a795b8","fields":{"slug":"/data-jpa-slice-page/"},"frontmatter":{"title":"Spring Data JPA의 Slice & Page"}}},{"node":{"id":"e1ba92ee-0cf0-50c8-80bd-5da5075df8d1","fields":{"slug":"/data-jpa-auditing/"},"frontmatter":{"title":"Spring Data JPA의 Auditing"}}},{"node":{"id":"3e036508-c916-504e-9e8d-89f69332471e","fields":{"slug":"/separated-interface/"},"frontmatter":{"title":"외부와 의존성 분리하기"}}},{"node":{"id":"cade544a-16ef-58a3-b97c-824986a8395f","fields":{"slug":"/apply-rest-docs/"},"frontmatter":{"title":"MockMvc를 사용한 Spring RestDocs"}}},{"node":{"id":"87649d54-d59e-58a6-afd5-8491eb4113a8","fields":{"slug":"/properties-to-object/"},"frontmatter":{"title":"properties 객체로 다루기"}}},{"node":{"id":"eb380f6d-5a00-5a9e-a916-003fb292cc8a","fields":{"slug":"/test-fixture-constant/"},"frontmatter":{"title":"테스트에서 Entity 객체를 상수로 두면 안 되는 이유"}}},{"node":{"id":"9734e30a-b430-5922-919d-f53808a56eb9","fields":{"slug":"/what_is_nginx/"},"frontmatter":{"title":"NGINX 란?"}}},{"node":{"id":"9ebc6e21-2a76-5d42-be33-c2dae8c849b2","fields":{"slug":"/ssl_protocol/"},"frontmatter":{"title":"SSL을 통한 HTTPS통신 과정"}}},{"node":{"id":"fa5ad595-1f81-5a20-a884-2da69adee3c5","fields":{"slug":"/integration-test-slice-test/"},"frontmatter":{"title":"통합 테스트와 슬라이스 테스트"}}},{"node":{"id":"d8c66823-bb05-5e83-a6a1-2fd9af450b6f","fields":{"slug":"/query-invalidation/"},"frontmatter":{"title":"React-Query에서의 데이터 최신화 (Query Invalidation)"}}},{"node":{"id":"f5187517-342f-52a1-9092-d12c1a80d132","fields":{"slug":"/seperate-components/"},"frontmatter":{"title":"컴포넌트 분리 기준"}}},{"node":{"id":"d6249c8b-bea6-5c91-8477-d3dd15ad9b39","fields":{"slug":"/test-isolation/"},"frontmatter":{"title":"테스트 격리"}}},{"node":{"id":"98e390ef-fb19-5d01-a3ef-d14bc0e65176","fields":{"slug":"/dallog-jacoco/"},"frontmatter":{"title":"달록의 Jacoco 적용기 (feat. Gradle)"}}},{"node":{"id":"33d19946-de0c-5b41-bfa0-d7c3fd80f10b","fields":{"slug":"/google-refresh-token/"},"frontmatter":{"title":"Google은 Refresh Token을 쉽게 내주지 않는다."}}},{"node":{"id":"8168857d-a82c-5608-bd40-cea4b917d17d","fields":{"slug":"/submodule/"},"frontmatter":{"title":"달록 서브모듈 도입기"}}},{"node":{"id":"836fc724-7e2f-5c7a-a42b-c0cc9163167a","fields":{"slug":"/dallog-flyway/"},"frontmatter":{"title":"달록의 데이터베이스 마이그레이션을 위한 Flyway 적용기"}}},{"node":{"id":"7a3bde6d-746b-56fd-8d91-0d8059ebf1f8","fields":{"slug":"/json-property-json-naming/"},"frontmatter":{"title":"@JsonProperty, @JsonNaming"}}},{"node":{"id":"50673f5c-f835-5982-b70c-b77e5a352a2c","fields":{"slug":"/servlet-life-cycle/"},"frontmatter":{"title":"서블릿 생명주기와 직접만든 톰캣을 통한 의문점"}}}]},"previous":{"fields":{"slug":"/continuous-deploy-with-jenkins-2-frontend/"},"frontmatter":{"title":"젠킨스를 사용한 달록팀의 지속적 배포 환경 구축기 (2) - 프론트엔드편"}},"next":{"fields":{"slug":"/mechanism-of-jpa/"},"frontmatter":{"title":"JPA 작동 메커니즘"}}},"pageContext":{"id":"cade544a-16ef-58a3-b97c-824986a8395f","series":null,"previousPostId":"f88fe712-01b6-51ca-84a7-2ded8ef8ab98","nextPostId":"27e0338e-3bf4-50e6-9280-70f1ee8da256"}},"staticQueryHashes":[]}