{"componentChunkName":"component---src-templates-post-jsx","path":"/submodule/","result":{"data":{"site":{"siteMetadata":{"title":"dal.log"}},"markdownRemark":{"id":"8168857d-a82c-5608-bd40-cea4b917d17d","excerpt":"이 글은 우테코 달록팀 크루 '매트'가 작성했습니다. 달록 서브모듈 도입기 Spring Boot를 활용하여 애플리케이션을 개발할 때 ,  통해 다양한 설정 정보를 지정할 수 있다. 우리 달록도 을 통해 애플리케이션 구동 시 필요한 정보들을 명시하여 사용하고 있다. 하지만 이러한 설정 정보는 애플리케이션이 실행되는 환경에 따라 분리되어야 하며 private…","html":"<blockquote>\n<p>이 글은 우테코 달록팀 크루 '<a href=\"https://github.com/hyeonic\">매트</a>'가 작성했습니다.</p>\n</blockquote>\n<h2>달록 서브모듈 도입기</h2>\n<p>Spring Boot를 활용하여 애플리케이션을 개발할 때 <code class=\"language-text\">application.properties</code>, <code class=\"language-text\">application.yml</code> 통해 다양한 설정 정보를 지정할 수 있다. 우리 <a href=\"https://github.com/woowacourse-teams/2022-dallog\">달록</a>도 <code class=\"language-text\">application.yml</code>을 통해 애플리케이션 구동 시 필요한 정보들을 명시하여 사용하고 있다.</p>\n<p>하지만 이러한 설정 정보는 애플리케이션이 실행되는 환경에 따라 분리되어야 하며 private한 정보까지 명시해야 했다. 우리 달록은 이것을 이루기 위해 환경 변수를 활용하여 설정 정보를 명시하였다.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">spring</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">sql</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">init</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">mode</span><span class=\"token punctuation\">:</span> always\n\n  <span class=\"token key atrule\">datasource</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">url</span><span class=\"token punctuation\">:</span> jdbc<span class=\"token punctuation\">:</span>h2<span class=\"token punctuation\">:</span>~/dallog;MODE=MYSQL;DB_CLOSE_DELAY=<span class=\"token punctuation\">-</span>1;DB_CLOSE_ON_EXIT=FALSE\n    <span class=\"token key atrule\">username</span><span class=\"token punctuation\">:</span> sa\n\n  <span class=\"token key atrule\">jpa</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">properties</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">hibernate</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">format_sql</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n    <span class=\"token key atrule\">show-sql</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n\n    <span class=\"token key atrule\">hibernate</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">ddl-auto</span><span class=\"token punctuation\">:</span> create\n    <span class=\"token key atrule\">defer-datasource-initialization</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n\n  <span class=\"token key atrule\">data</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">web</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">pageable</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">max-page-size</span><span class=\"token punctuation\">:</span> <span class=\"token number\">100</span>\n\n  <span class=\"token key atrule\">h2</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">console</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">enabled</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n\n<span class=\"token key atrule\">logging</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">level</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">root</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>LOGGING_LEVEL<span class=\"token punctuation\">}</span>\n  <span class=\"token key atrule\">file</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"./logs/dallog.log\"</span>\n  <span class=\"token key atrule\">logback</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">rollingpolicy</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">file-name-pattern</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"./logs/dallog-%d{yyyy-MM-dd}-%i.log\"</span>\n      <span class=\"token key atrule\">max-file-size</span><span class=\"token punctuation\">:</span> 5MB\n      <span class=\"token key atrule\">total-size-cap</span><span class=\"token punctuation\">:</span> 100MB\n\n<span class=\"token key atrule\">oauth</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">google</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">client-id</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>GOOGLE_CLIENT_ID<span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">client-secret</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>GOOGLE_CLIENT_SECRET<span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">redirect-uri</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>GOOGLE_REDIRECT_URI<span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">oauth-end-point</span><span class=\"token punctuation\">:</span> https<span class=\"token punctuation\">:</span>//accounts.google.com/o/oauth2/v2/auth\n    <span class=\"token key atrule\">response-type</span><span class=\"token punctuation\">:</span> code\n    <span class=\"token key atrule\">scopes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> https<span class=\"token punctuation\">:</span>//www.googleapis.com/auth/userinfo.profile\n      <span class=\"token punctuation\">-</span> https<span class=\"token punctuation\">:</span>//www.googleapis.com/auth/userinfo.email\n    <span class=\"token key atrule\">token-uri</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>GOOGLE_TOKEN_URI<span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">grant-type</span><span class=\"token punctuation\">:</span> authorization_code\n\n<span class=\"token key atrule\">report</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">webhook</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">discord</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>DISCORD_WEBHOOK_URI<span class=\"token punctuation\">}</span>\n\n<span class=\"token key atrule\">security</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">jwt</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">token</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">secret-key</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>JWT_SECRET_KEY<span class=\"token punctuation\">}</span>\n      <span class=\"token key atrule\">expire-length</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>JWT_EXPIRE_LENGTH<span class=\"token punctuation\">}</span></code></pre></div>\n<p>환경 변수는 <code class=\"language-text\">${}</code>와 같은 형식으로 작성된다. 가장 큰 장점은 빠르게 적용이 가능하다는 것이다. 하지만 모든 팀원과 개발 및 운영 서버에 환경 변수를 물리적으로 세팅해두어야 한다. 만약 개발 중 환경 변수가 추가된다면 모든 팀원이 동일하게 추가해야 하며 개발 및 운영 환경에도 동일하게 세팅해주어야 하는 단점이 있다.</p>\n<h2>서브모듈 도입</h2>\n<p>앞서 언급한 단점들로 우리는 환경 변수를 통한 설정 정보 관리의 불편함을 느끼게 되었다. 이러한 불편함을 개선하기 위해 서브모듈을 도입하기로 결정하였다. 서브모듈을 통해 필요한 환경 정보를 유연하게 관리하고, repository를 통한 형상 관리 까지 진행할 수 있게 되었다. 또한 서브모듈을 활용하게 되면 <code class=\"language-text\">JWT의 Secret Key</code>와 같은 private한 정보들을 private repository를 통해 안전하게 관리할 수 있다. </p>\n<h3>private repository 생성</h3>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 156px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/2b95c462ec32434ca7951b98ab671087/2863b/config-repository.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 27.564102564102566%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABU0lEQVQY00VR20rDQBDNZ/oVivgJguiLiohSBJ+ktoIi2ha03oqgFfrQFrz1oZVQTeomTbZJs9ndtMfd2MvDMHNmz5nZPWtwkSCKBYaMp3lacy4QqhxGPM26x7ic91QEk7NECjCl09joETclC/E/QA/Ute3FkIo4TiSSRAnUAo8GGKlaY4wkMJYKS7SsCH7IU2ycF8swuz+gUYKDiouzmo9s1cPurYNCnaLyMcBlPYBpe2i+fqLUDFBq+Mi9eDh66iPz4GIlb+PwsY+86hnVWgPtzhc6hGP1oof1IsFyzsb+vYvtawebVwqfOHhudvDWamPrhmKnTLCYtbBWINgoEezduVg6trCQ6cKwf10MQpZ6YHkMhMZp0CFHP+AwHZbeyrQc+JTCDcSMoy3ST9V+vn8PcapeZ3A5/xSuvIv5f+gF01r7FgupeHLW06F1bMLVWu3rH9QHuqeu4PooAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='config repository' title='config repository' src='/static/2b95c462ec32434ca7951b98ab671087/2863b/config-repository.png' srcset='/static/2b95c462ec32434ca7951b98ab671087/2863b/config-repository.png 156w' sizes='(max-width: 156px) 100vw, 156px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>먼저 환경 별 설정 정보와 private한 설정 정보를 모아두기 위한 <code class=\"language-text\">private repository</code>를 생성한다. repository의 이름을 <code class=\"language-text\">config</code>라고 설정한 것은 추후 언급할 예정이다. 필요한 파일을 해당 repository에 작성 후 <code class=\"language-text\">commit &amp; push</code>를 진행한다.</p>\n<h3>main repository에 서브모듈 추가</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> <span class=\"token function\">add</span> submodule https://github.com/dallog/<span class=\"token punctuation\">{</span>private repository<span class=\"token punctuation\">}</span>.git\nor\n$ <span class=\"token function\">git</span> <span class=\"token function\">add</span> submodule https://github.com/dallog/<span class=\"token punctuation\">{</span>private repository<span class=\"token punctuation\">}</span>.git <span class=\"token punctuation\">{</span>연결한 디렉토리<span class=\"token punctuation\">}</span> </code></pre></div>\n<p><code class=\"language-text\">{private repository}</code>에 앞서 생성한 private repository의 이름을 명시한다. 만약 뒤에 추가로 디렉토리의 위치를 인자로 전달하면 해당 디렉토리와 서브모듈이 연결된다.</p>\n<p>위 명령어를 작성하면 <code class=\"language-text\">.gitsubmodules</code> 파일이 생성된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[submodule \"backend/src/main/resources/config\"]\n        path = backend/src/main/resources/config\n        url = https://github.com/dallog/config.git</code></pre></div>\n<p>우리 달록은 <code class=\"language-text\">backend/src/main/resources/config</code>로 위치를 지정하였다. 이제 새롭게 추가된 서브모듈 설정을 <code class=\"language-text\">commit &amp; push</code> 한다. 새로운 기능이 추가되었기 때문에 PR을 시도한다.</p>\n<p>PR에 commit 내역을 살펴보면 아래와 같은 commit 내역을 확인할 수 있다.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/52089598cd51b079e628f82394aee9bf/2f7b1/commit-1.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 17.058823529411764%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAk0lEQVQI12XL0QqCMACFYd//pXqCLAosInJmmU03Tdsmhf4tkaC6+PjPzQla0xPLirOqyYuKS1nT2Af37kk7Gbf7p27Gs5S1Qep2/AWrqmYmC5Zas5WaSCp2uiFuHXFjfe1YYQ1JZ7858yG81FmC/ZAyHyI23YGsUySVYJ0JwlPMwns3TA9E6sgVRU75Q01KZK95AQJW4mxfN8VDAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='commit 1' title='commit 1' src='/static/52089598cd51b079e628f82394aee9bf/ca1dc/commit-1.png' srcset='/static/52089598cd51b079e628f82394aee9bf/e7570/commit-1.png 170w,\n/static/52089598cd51b079e628f82394aee9bf/f46e7/commit-1.png 340w,\n/static/52089598cd51b079e628f82394aee9bf/ca1dc/commit-1.png 680w,\n/static/52089598cd51b079e628f82394aee9bf/2f7b1/commit-1.png 909w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n<span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/ca81631c5100cce0f1bf686174e01e09/8728b/commit-2.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 10%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAUklEQVQI113KUQ6AMAgDUO9/UDMVCJNtDDYT0T9NXvvRdCmtkwjxCchAD6R8IEtp6q72kaW+Svyb2pJ2AMRENQFvyCtpN++RMce8fmINHm0jDjctI3LcC47IlAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='commit 2' title='commit 2' src='/static/ca81631c5100cce0f1bf686174e01e09/ca1dc/commit-2.png' srcset='/static/ca81631c5100cce0f1bf686174e01e09/e7570/commit-2.png 170w,\n/static/ca81631c5100cce0f1bf686174e01e09/f46e7/commit-2.png 340w,\n/static/ca81631c5100cce0f1bf686174e01e09/ca1dc/commit-2.png 680w,\n/static/ca81631c5100cce0f1bf686174e01e09/8728b/commit-2.png 903w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>잘 연결된 것을 확인할 수 있다.</p>\n<h2>submodule 적용 시키기</h2>\n<p>위 PR이 merge가 되면 main repository에 서브모듈 디렉토리가 추가될 것이다. 만약 최초로 main repository를 clone하는 경우 아래와 같이 진행한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> clone --recurse-submodules https://github.com/woowacourse-teams/2022-dallog.git</code></pre></div>\n<ul>\n<li><code class=\"language-text\">--recurse-submodules</code>: clone 시점에 서브모듈을 자동으로 <code class=\"language-text\">init</code>하고 <code class=\"language-text\">update</code>한다.</li>\n</ul>\n<p>위 과정은 아래와 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> clone https://github.com/woowacourse-teams/2022-dallog.git\n$ <span class=\"token function\">git</span> submodule init\n$ <span class=\"token function\">git</span> submodule update\n\nor\n\n$ <span class=\"token function\">git</span> clone https://github.com/woowacourse-teams/2022-dallog.git\n$ <span class=\"token function\">git</span> submodule update <span class=\"token parameter variable\">--init</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">git submodule update --init</code>: 현재 main repository에 연결되어 있는 sub repository의 정보를 가지고 update를 진행한다. main repository의 commit 당시의 snap shot을 가져오는 것이다. 즉 매번 최신의 private repository commit을 가져오는 것이 아니라 main repository의 기준으로 반영된 commit을 가져온다.</li>\n</ul>\n<h2>작업 중간에 서브모듈이 추가되어 반영해야 하는 경우</h2>\n<p>우리 달록은 fetch + rebase를 기반으로 프로젝트를 최신화하고 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> pull <span class=\"token parameter variable\">--rebase</span> upstream develop</code></pre></div>\n<p>main repository를 pull 한다고 서브모듈의 repository까지 최신화 되지 않는다. 각 서브모듈을 일괄적으로 업데이트 해야 한다. 각각의 sub repository에서 fetch + merge 혹은 pull을 진행해도 되지만 아래와 같이 한 번에 진행할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> submodule update <span class=\"token parameter variable\">--init</span></code></pre></div>\n<p>해당 명령어를 통해 main repository에 추가 반영된 서브모듈 repository 정보를 가져올 수 있다.</p>\n<h2>주의사항</h2>\n<p>서브모듈이 수정되면 남은 팀원에게 변경사항에 대해 전달해야 한다. 우리는 서브모듈을 하나의 main 브랜치로 관리하고 있기 때문에 동시에 수정할 경우 충돌될 가능성이 크다. 왠만하면 서브모듈에 대한 작업은 동시에 진행하지 않도록 한다.</p>\n<p>서브모듈이 변동될 경우 나머지 팀원들은 앞서 작성한 명령어를 통해 일괄적으로 서브모듈의 변경점을 반영해야 한다. 서브모듈을 변경한 사람은 자신이 어떤 이유로 수정했는지 명시한 뒤 PR 작성 시 나머지 팀원이 잘 적용할 수 있도록 가이드 라인을 명시해둔다.</p>\n<h2>[번외] 왜 config인가?</h2>\n<blockquote>\n<p>Spring Boot will automatically find and load <code class=\"language-text\">application.properties</code> and <code class=\"language-text\">application.yaml</code> files from the following locations when your application starts:</p>\n</blockquote>\n<p>Spring Boot 애플리케이션은 시작될 때 다음 위치에서 자동으로 <code class=\"language-text\">application.properties</code> 및 <code class=\"language-text\">application.yml</code> 파일을 찾아 로드한다. </p>\n<ul>\n<li>\n<p>From the classpath</p>\n<ul>\n<li>The classpath root</li>\n<li>The classpath <code class=\"language-text\">/config</code> package</li>\n</ul>\n</li>\n<li>\n<p>From the current directory</p>\n<ul>\n<li>The current directory</li>\n<li>The <code class=\"language-text\">/config</code> subdirectory in the current directory</li>\n<li>Immediate child directories of the <code class=\"language-text\">/config</code> subdirectory</li>\n</ul>\n</li>\n</ul>\n<blockquote>\n<p>The list is ordered by precedence (with values from lower items overriding earlier ones). Documents from the loaded files are added as PropertySources to the Spring Environment.</p>\n</blockquote>\n<p>목록은 우선 순위에 따라 정렬된다(하위 항목의 값이 이전 항목보다 우선이다). 로드된 파일의 문서는 스프링 환경에 속성 소스로 추가된다. 정리하면 아래로 갈수록 높은 우선순위를 가진다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ConfigFileApplicationListener</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">EnvironmentPostProcessor</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">SmartApplicationListener</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Ordered</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">DEFAULT_SEARCH_LOCATIONS</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"classpath:/,classpath:/config/,file:./,file:./config/*/,file:./config/\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Maven, Gradle를 활용하여 Spring 프로젝트를 생성하면 기본적으로 리소스 파일은 <code class=\"language-text\">src/main/resources</code>에 저장된다. <code class=\"language-text\">.java</code>와 같이 컴파일 대상이 아닌 리소스 파일은 resources 디렉토리에 저장하고 관리한다. 즉 리소스 파일의 Classpath는 기본적으로 <code class=\"language-text\">src/main/resources</code>가 된다. 만약 해당 위치에 설정 관련 리소스가 존재하지 않는 경우 다음 우선 순위인 <code class=\"language-text\">src/main/resources/config</code>를 찾아 설정 정보를 로드한다.</p>\n<blockquote>\n<p>Classpath는 JVM이 실행할 때 class 파일을 찾는데 기준이 되는 경로를 의미한다. Spring은 이러한 classpath를 통해 필요한 resources를 가져온다.</p>\n</blockquote>\n<p>물론 외부에서 jar 파일을 실행할 때 아래와 같이 <code class=\"language-text\">spring.config.location</code> 설정을 통해 기본 위치를 변경할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">java</span> <span class=\"token parameter variable\">-jar</span> myproject.jar <span class=\"token parameter variable\">--spring.config.location</span><span class=\"token operator\">=</span>classpath:custom-config/</code></pre></div>\n<p>이렇게 애플리케이션 실행 시점에 의존하여 주입하는 것 보다 기본으로 제공하는 우선 순위에 따라 조정하는 것이 더욱 편하다 판단하여 <code class=\"language-text\">config</code>라는 이름을 가진 <code class=\"language-text\">private repository</code>를 생성하여 반영했다.</p>\n<h2>정리</h2>\n<p>우리 달록은 다양한 환경과 private한 정보 관리를 위해 서브모듈을 도입하게 되었다. 환경 변수를 사용할 때 보다 적절한 형상 관리와 팀원 간의 정보 공유를 통해 편리하게 설정 정보를 관리할 수 있게 되었다.</p>\n<p>장점만 있는 것은 아닌다. private repository와 서브모듈에 대한 관리 포인트가 늘어나게 되었다. 모든 팀원들이 서브모듈에 대한 배경지식이 없다면 최악의 경우 commit 기록이 꼬이게 되어 설정 정보가 온전하게 적용되지 않을 수 있다. 또한 <code class=\"language-text\">외부 환경(jenkins 등)</code>에서 <code class=\"language-text\">CD</code>를 진행할 때도 서브모듈을 적용한 repository도 함께 pull 받기 위해 추가적인 설정이 필요해진다.</p>\n<p>서브모듈은 편리한 부분도 많지만 결국 관리해야 할 포인트가 늘어난다는 단점도 있다. 팀원과의 충분한 협의와 프로젝트의 규모를 잘 고민한 뒤 적용하는 것이 바람직하다 판단한다.</p>\n<h3>References.</h3>\n<p><a href=\"https://tecoble.techcourse.co.kr/post/2021-07-31-git-submodule/\">git submodule로 중요한 정보 관리하기</a><br>\n<a href=\"https://docs.spring.io/spring-boot/docs/2.7.0/reference/htmlsingle/#features.external-config\">7.2. Externalized Configuration</a></p>","frontmatter":{"title":"달록 서브모듈 도입기","date":"August 26, 2022","update":"August 26, 2022","tags":["매트","BE","submodule","서브모듈"],"series":null},"fields":{"slug":"/submodule/","readingTime":{"minutes":10.99}}},"seriesList":{"edges":[{"node":{"id":"a621dc7b-8590-5ec6-9b52-3d9e5182486d","fields":{"slug":"/appearance-background-of-jpa/"},"frontmatter":{"title":"JPA 등장배경"}}},{"node":{"id":"9d2a87b6-2b9c-5b87-b790-3426d17c2d8e","fields":{"slug":"/intellij-final-keyword/"},"frontmatter":{"title":"IntelliJ에서 메소드 추출한 메소드의 파라미터에 final 키워드 자동 추가하기"}}},{"node":{"id":"251e9767-1c92-5cf5-9cef-2c4a42c10df2","fields":{"slug":"/git-branch-strategy/"},"frontmatter":{"title":"달록팀의 git 브랜치 전략을 소개합니다."}}},{"node":{"id":"5090cce3-0c1f-5376-badc-1d25e44c1bd9","fields":{"slug":"/infinite-scroll/"},"frontmatter":{"title":"React에서 무한 스크롤 구현하기"}}},{"node":{"id":"bcb53ba5-0286-5d10-96c2-fdcb88e2cc60","fields":{"slug":"/package-structure/"},"frontmatter":{"title":"달록에 적절한 패키지 구조 고민하기"}}},{"node":{"id":"a7fc89de-f37c-596e-a81d-3d4fe5a795b8","fields":{"slug":"/data-jpa-slice-page/"},"frontmatter":{"title":"Spring Data JPA의 Slice & Page"}}},{"node":{"id":"e1ba92ee-0cf0-50c8-80bd-5da5075df8d1","fields":{"slug":"/data-jpa-auditing/"},"frontmatter":{"title":"Spring Data JPA의 Auditing"}}},{"node":{"id":"3e036508-c916-504e-9e8d-89f69332471e","fields":{"slug":"/separated-interface/"},"frontmatter":{"title":"외부와 의존성 분리하기"}}},{"node":{"id":"cade544a-16ef-58a3-b97c-824986a8395f","fields":{"slug":"/apply-rest-docs/"},"frontmatter":{"title":"MockMvc를 사용한 Spring RestDocs"}}},{"node":{"id":"87649d54-d59e-58a6-afd5-8491eb4113a8","fields":{"slug":"/properties-to-object/"},"frontmatter":{"title":"properties 객체로 다루기"}}},{"node":{"id":"eb380f6d-5a00-5a9e-a916-003fb292cc8a","fields":{"slug":"/test-fixture-constant/"},"frontmatter":{"title":"테스트에서 Entity 객체를 상수로 두면 안 되는 이유"}}},{"node":{"id":"9734e30a-b430-5922-919d-f53808a56eb9","fields":{"slug":"/what_is_nginx/"},"frontmatter":{"title":"NGINX 란?"}}},{"node":{"id":"9ebc6e21-2a76-5d42-be33-c2dae8c849b2","fields":{"slug":"/ssl_protocol/"},"frontmatter":{"title":"SSL을 통한 HTTPS통신 과정"}}},{"node":{"id":"fa5ad595-1f81-5a20-a884-2da69adee3c5","fields":{"slug":"/integration-test-slice-test/"},"frontmatter":{"title":"통합 테스트와 슬라이스 테스트"}}},{"node":{"id":"d8c66823-bb05-5e83-a6a1-2fd9af450b6f","fields":{"slug":"/query-invalidation/"},"frontmatter":{"title":"React-Query에서의 데이터 최신화 (Query Invalidation)"}}},{"node":{"id":"f5187517-342f-52a1-9092-d12c1a80d132","fields":{"slug":"/seperate-components/"},"frontmatter":{"title":"컴포넌트 분리 기준"}}},{"node":{"id":"d6249c8b-bea6-5c91-8477-d3dd15ad9b39","fields":{"slug":"/test-isolation/"},"frontmatter":{"title":"테스트 격리"}}},{"node":{"id":"98e390ef-fb19-5d01-a3ef-d14bc0e65176","fields":{"slug":"/dallog-jacoco/"},"frontmatter":{"title":"달록의 Jacoco 적용기 (feat. Gradle)"}}},{"node":{"id":"33d19946-de0c-5b41-bfa0-d7c3fd80f10b","fields":{"slug":"/google-refresh-token/"},"frontmatter":{"title":"Google은 Refresh Token을 쉽게 내주지 않는다."}}},{"node":{"id":"8168857d-a82c-5608-bd40-cea4b917d17d","fields":{"slug":"/submodule/"},"frontmatter":{"title":"달록 서브모듈 도입기"}}},{"node":{"id":"836fc724-7e2f-5c7a-a42b-c0cc9163167a","fields":{"slug":"/dallog-flyway/"},"frontmatter":{"title":"달록의 데이터베이스 마이그레이션을 위한 Flyway 적용기"}}},{"node":{"id":"7a3bde6d-746b-56fd-8d91-0d8059ebf1f8","fields":{"slug":"/json-property-json-naming/"},"frontmatter":{"title":"@JsonProperty, @JsonNaming"}}},{"node":{"id":"50673f5c-f835-5982-b70c-b77e5a352a2c","fields":{"slug":"/servlet-life-cycle/"},"frontmatter":{"title":"서블릿 생명주기와 직접만든 톰캣을 통한 의문점"}}},{"node":{"id":"61e7f4d1-7b3a-5968-bfe8-c3f6efb88748","fields":{"slug":"/preparing-for-performance-test/"},"frontmatter":{"title":"톰캣 튜닝을 위한 달록의 서버 성능 테스트 준비 과정"}}},{"node":{"id":"9272061d-68c6-5f82-a961-0e2efe0fd6be","fields":{"slug":"/cyclic-dependency/"},"frontmatter":{"title":"cyclic dependency"}}},{"node":{"id":"6e779308-f266-58af-bfcc-e9fee6d39a98","fields":{"slug":"/multi-datasource-issue-with-osiv/"},"frontmatter":{"title":"대체 왜 DataSource 라우팅이 안되는거야!? (feat. OSIV)"}}},{"node":{"id":"0e63245e-c52c-5977-9f60-f94ee0fd00fc","fields":{"slug":"/hikari-cp-theory/"},"frontmatter":{"title":"HikariCP와 적절한 풀 사이즈 고민하기 (이론편)"}}}]},"previous":{"fields":{"slug":"/google-refresh-token/"},"frontmatter":{"title":"Google은 Refresh Token을 쉽게 내주지 않는다."}},"next":{"fields":{"slug":"/dallog-flyway/"},"frontmatter":{"title":"달록의 데이터베이스 마이그레이션을 위한 Flyway 적용기"}}},"pageContext":{"id":"8168857d-a82c-5608-bd40-cea4b917d17d","series":null,"previousPostId":"33d19946-de0c-5b41-bfa0-d7c3fd80f10b","nextPostId":"836fc724-7e2f-5c7a-a42b-c0cc9163167a"}},"staticQueryHashes":[]}